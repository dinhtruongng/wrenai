import os

from litellm import completion  # Explicitly import completion for clarity

# --- Configuration ---
# 1. Set your OpenRouter API Key as an environment variable
#    On Linux/macOS: export OPENROUTER_API_KEY='your-actual-api-key'
#    On Windows (cmd): set OPENROUTER_API_KEY=your-actual-api-key
#    On Windows (PowerShell): $env:OPENROUTER_API_KEY='your-actual-api-key'
#    Alternatively, you can uncomment and set it directly here (less secure):
# os.environ["OPENROUTER_API_KEY"] = "your-actual-api-key"

API_KEY = os.getenv("OPENROUTER_API_KEY")

# --- Define the conversation messages ---
# This is the input to the model. It follows the standard chat format.
prompt = {
    "prompt": "\n\nData Model Specification:\n[{'name': 'myspa_users', 'columns': [{'name': 'acc_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'acc_name'}}, {'name': 'account_number', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'account_number'}}, {'name': 'address', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'address'}}, {'name': 'bank_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'bank_name'}}, {'name': 'birthday', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'birthday'}}, {'name': 'branch_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'branch_id'}}, {'name': 'brand_app', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'brand_app'}}, {'name': 'created_by_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_by_id'}}, {'name': 'created_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_date'}}, {'name': 'customer_backup_code', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'customer_backup_code'}}, {'name': 'deleted', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'deleted'}}, {'name': 'due_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'due_date'}}, {'name': 'email', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'email'}}, {'name': 'etl_inserted', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'etl_inserted'}}, {'name': 'facebook', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'facebook'}}, {'name': 'fullname', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'fullname'}}, {'name': 'height', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'height'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'identify_img', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'identify_img'}}, {'name': 'identify_number', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'identify_number'}}, {'name': 'image', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'image'}}, {'name': 'interest_service_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'interest_service_id'}}, {'name': 'issue_area', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'issue_area'}}, {'name': 'issue_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'issue_date'}}, {'name': 'job', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'job'}}, {'name': 'level_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'level_id'}}, {'name': 'loginable', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'loginable'}}, {'name': 'modified_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'modified_date'}}, {'name': 'nationality', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'nationality'}}, {'name': 'platform', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'platform'}}, {'name': 'profile_tag_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'profile_tag_id'}}, {'name': 'sex', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'sex'}}, {'name': 'site_currency', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'site_currency'}}, {'name': 'site_lang', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'site_lang'}}, {'name': 'source_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'source_id'}}, {'name': 'staff_id_referral', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'staff_id_referral'}}, {'name': 'stage_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'stage_name'}}, {'name': 'status', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'telephone', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'telephone'}}, {'name': 'user_from_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'user_from_id'}}, {'name': 'user_level_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'user_level_id'}}, {'name': 'vocative', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'vocative'}}, {'name': 'weight', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'weight'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_users'}, 'cached': False, 'properties': {'displayName': 'myspa_users'}, 'primaryKey': ''}, {'name': 'fb_ad_campaign_metrics_tmp', 'columns': [{'name': 'account_currency', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'account_currency'}}, {'name': 'account_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'account_id'}}, {'name': 'account_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'account_name'}}, {'name': 'action_values', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'action_values'}}, {'name': 'actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'actions'}}, {'name': 'ad_click_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'ad_click_actions'}}, {'name': 'ad_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'ad_id'}}, {'name': 'ad_impression_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'ad_impression_actions'}}, {'name': 'ad_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'ad_name'}}, {'name': 'adset_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'adset_id'}}, {'name': 'adset_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'adset_name'}}, {'name': 'attribution_setting', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'attribution_setting'}}, {'name': 'auction_bid', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'auction_bid'}}, {'name': 'auction_competitiveness', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'auction_competitiveness'}}, {'name': 'auction_max_competitor_bid', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'auction_max_competitor_bid'}}, {'name': 'buying_type', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'buying_type'}}, {'name': 'campaign_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'campaign_id'}}, {'name': 'campaign_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'campaign_name'}}, {'name': 'canvas_avg_view_percent', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'canvas_avg_view_percent'}}, {'name': 'canvas_avg_view_time', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'canvas_avg_view_time'}}, {'name': 'catalog_segment_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'catalog_segment_actions'}}, {'name': 'catalog_segment_value', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'catalog_segment_value'}}, {'name': 'catalog_segment_value_mobile_purchase_roas', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'catalog_segment_value_mobile_purchase_roas'}}, {'name': 'catalog_segment_value_omni_purchase_roas', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'catalog_segment_value_omni_purchase_roas'}}, {'name': 'catalog_segment_value_website_purchase_roas', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'catalog_segment_value_website_purchase_roas'}}, {'name': 'clicks', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'clicks'}}, {'name': 'conversion_values', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'conversion_values'}}, {'name': 'conversions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'conversions'}}, {'name': 'converted_product_quantity', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'converted_product_quantity'}}, {'name': 'converted_product_value', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'converted_product_value'}}, {'name': 'cost_per_15_sec_video_view', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_15_sec_video_view'}}, {'name': 'cost_per_2_sec_continuous_video_view', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_2_sec_continuous_video_view'}}, {'name': 'cost_per_action_type', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_action_type'}}, {'name': 'cost_per_ad_click', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_ad_click'}}, {'name': 'cost_per_conversion', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_conversion'}}, {'name': 'cost_per_dda_countby_convs', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_dda_countby_convs'}}, {'name': 'cost_per_inline_link_click', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_inline_link_click'}}, {'name': 'cost_per_inline_post_engagement', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_inline_post_engagement'}}, {'name': 'cost_per_one_thousand_ad_impression', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_one_thousand_ad_impression'}}, {'name': 'cost_per_outbound_click', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_outbound_click'}}, {'name': 'cost_per_thruplay', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_thruplay'}}, {'name': 'cost_per_unique_action_type', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_unique_action_type'}}, {'name': 'cost_per_unique_click', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_unique_click'}}, {'name': 'cost_per_unique_conversion', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_unique_conversion'}}, {'name': 'cost_per_unique_inline_link_click', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_unique_inline_link_click'}}, {'name': 'cost_per_unique_outbound_click', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cost_per_unique_outbound_click'}}, {'name': 'cpc', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cpc'}}, {'name': 'cpm', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cpm'}}, {'name': 'cpp', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'cpp'}}, {'name': 'created_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_time'}}, {'name': 'ctr', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'ctr'}}, {'name': 'date_start', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'date_start'}}, {'name': 'date_stop', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'date_stop'}}, {'name': 'dda_countby_convs', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'dda_countby_convs'}}, {'name': 'dda_results', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'dda_results'}}, {'name': 'frequency', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'frequency'}}, {'name': 'full_view_impressions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'full_view_impressions'}}, {'name': 'full_view_reach', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'full_view_reach'}}, {'name': 'impressions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'impressions'}}, {'name': 'inline_link_click_ctr', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'inline_link_click_ctr'}}, {'name': 'inline_link_clicks', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'inline_link_clicks'}}, {'name': 'inline_post_engagement', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'inline_post_engagement'}}, {'name': 'instagram_upcoming_event_reminders_set', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'instagram_upcoming_event_reminders_set'}}, {'name': 'instant_experience_clicks_to_open', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'instant_experience_clicks_to_open'}}, {'name': 'instant_experience_clicks_to_start', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'instant_experience_clicks_to_start'}}, {'name': 'instant_experience_outbound_clicks', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'instant_experience_outbound_clicks'}}, {'name': 'interactive_component_tap', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'interactive_component_tap'}}, {'name': 'marketing_messages_delivery_rate', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'marketing_messages_delivery_rate'}}, {'name': 'mobile_app_purchase_roas', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'mobile_app_purchase_roas'}}, {'name': 'objective', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'objective'}}, {'name': 'optimization_goal', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'optimization_goal'}}, {'name': 'outbound_clicks', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'outbound_clicks'}}, {'name': 'outbound_clicks_ctr', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'outbound_clicks_ctr'}}, {'name': 'place_page_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'place_page_name'}}, {'name': 'purchase_roas', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'purchase_roas'}}, {'name': 'qualifying_question_qualify_answer_rate', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'qualifying_question_qualify_answer_rate'}}, {'name': 'reach', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'reach'}}, {'name': 'social_spend', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'social_spend'}}, {'name': 'spend', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'spend'}}, {'name': 'updated_time', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_time'}}, {'name': 'video_30_sec_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_30_sec_watched_actions'}}, {'name': 'video_avg_time_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_avg_time_watched_actions'}}, {'name': 'video_continuous_2_sec_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_continuous_2_sec_watched_actions'}}, {'name': 'video_p100_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_p100_watched_actions'}}, {'name': 'video_p25_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_p25_watched_actions'}}, {'name': 'video_p50_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_p50_watched_actions'}}, {'name': 'video_p75_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_p75_watched_actions'}}, {'name': 'video_p95_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_p95_watched_actions'}}, {'name': 'video_play_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_play_actions'}}, {'name': 'video_play_curve_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_play_curve_actions'}}, {'name': 'video_play_retention_0_to_15s_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_play_retention_0_to_15s_actions'}}, {'name': 'video_play_retention_20_to_60s_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_play_retention_20_to_60s_actions'}}, {'name': 'video_play_retention_graph_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_play_retention_graph_actions'}}, {'name': 'video_time_watched_actions', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'video_time_watched_actions'}}, {'name': 'website_ctr', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'website_ctr'}}, {'name': 'website_purchase_roas', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'website_purchase_roas'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'fb_ad_campaign_metrics_tmp'}, 'cached': False, 'properties': {'displayName': 'fb_ad_campaign_metrics_tmp'}, 'primaryKey': ''}, {'name': 'fb_ad_campaigns', 'columns': [{'name': 'account_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'account_id'}}, {'name': 'adlabels', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'adlabels'}}, {'name': 'bid_strategy', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'bid_strategy'}}, {'name': 'boosted_object_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'boosted_object_id'}}, {'name': 'brand_lift_studies', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'brand_lift_studies'}}, {'name': 'budget_rebalance_flag', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'budget_rebalance_flag'}}, {'name': 'budget_remaining', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'budget_remaining'}}, {'name': 'buying_type', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'buying_type'}}, {'name': 'campaign_group_active_time', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'campaign_group_active_time'}}, {'name': 'can_create_brand_lift_study', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'can_create_brand_lift_study'}}, {'name': 'can_use_spend_cap', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'can_use_spend_cap'}}, {'name': 'configured_status', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'configured_status'}}, {'name': 'created_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_time'}}, {'name': 'daily_budget', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'daily_budget'}}, {'name': 'effective_status', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'effective_status'}}, {'name': 'has_secondary_skadnetwork_reporting', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'has_secondary_skadnetwork_reporting'}}, {'name': 'id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'is_budget_schedule_enabled', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_budget_schedule_enabled'}}, {'name': 'is_skadnetwork_attribution', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_skadnetwork_attribution'}}, {'name': 'issues_info', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'issues_info'}}, {'name': 'last_budget_toggling_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'last_budget_toggling_time'}}, {'name': 'lifetime_budget', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'lifetime_budget'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'objective', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'objective'}}, {'name': 'pacing_type', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'pacing_type'}}, {'name': 'primary_attribution', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'primary_attribution'}}, {'name': 'promoted_object', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'promoted_object'}}, {'name': 'smart_promotion_type', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'smart_promotion_type'}}, {'name': 'source_campaign', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'source_campaign'}}, {'name': 'source_campaign_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'source_campaign_id'}}, {'name': 'special_ad_categories', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'special_ad_categories'}}, {'name': 'special_ad_category', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'special_ad_category'}}, {'name': 'special_ad_category_country', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'special_ad_category_country'}}, {'name': 'spend_cap', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'spend_cap'}}, {'name': 'start_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'start_time'}}, {'name': 'status', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'stop_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'stop_time'}}, {'name': 'topline_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'topline_id'}}, {'name': 'updated_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_time'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'fb_ad_campaigns'}, 'cached': False, 'properties': {'displayName': 'fb_ad_campaigns'}, 'primaryKey': ''}, {'name': 'myspa_branches', 'columns': [{'name': 'address', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'address'}}, {'name': 'created_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_at'}}, {'name': 'district_code', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'district_code'}}, {'name': 'full_address', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'full_address'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'image', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'image'}}, {'name': 'image_url', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'image_url'}}, {'name': 'is_active', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_active'}}, {'name': 'latitude', 'type': 'FLOAT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'latitude'}}, {'name': 'location', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'location'}}, {'name': 'longitude', 'type': 'FLOAT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'longitude'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'organization_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'organization_id'}}, {'name': 'origin_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'origin_id'}}, {'name': 'province_code', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'province_code'}}, {'name': 'telephone', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'telephone'}}, {'name': 'updated_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_at'}}, {'name': 'ward_code', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'ward_code'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_branches'}, 'cached': False, 'properties': {'displayName': 'myspa_branches'}, 'primaryKey': ''}, {'name': 'customers', 'columns': [{'name': 'address', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'address'}}, {'name': 'code', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'code'}}, {'name': 'created_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_at'}}, {'name': 'current_step', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'current_step'}}, {'name': 'dob', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'dob'}}, {'name': 'emails', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'emails'}}, {'name': 'gender', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'gender'}}, {'name': 'id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'is_converted_to_crm', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_converted_to_crm'}}, {'name': 'job_title', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'job_title'}}, {'name': 'last_activity_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'last_activity_time'}}, {'name': 'last_call_in_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'last_call_in_time'}}, {'name': 'last_call_out_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'last_call_out_time'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'note_to', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'note_to'}}, {'name': 'phones', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'phones'}}, {'name': 'recent_sale_ids', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'recent_sale_ids'}}, {'name': 'ref_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'ref_id'}}, {'name': 'review_from', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'review_from'}}, {'name': 'service_ids', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'service_ids'}}, {'name': 'source', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'source'}}, {'name': 'tags', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'tags'}}, {'name': 'updated_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_at'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'customers'}, 'cached': False, 'properties': {'displayName': 'customers'}, 'primaryKey': ''}, {'name': 'myspa_staffs', 'columns': [{'name': 'avatar', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'avatar'}}, {'name': 'basic_salary', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'basic_salary'}}, {'name': 'booking_online', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'booking_online'}}, {'name': 'comment', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'comment'}}, {'name': 'degree', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'degree'}}, {'name': 'deleted', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'deleted'}}, {'name': 'experience', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'experience'}}, {'name': 'group_names', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'group_names'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'is_active_agency', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_active_agency'}}, {'name': 'is_agency', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_agency'}}, {'name': 'staff_code', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'staff_code'}}, {'name': 'story', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'story'}}, {'name': 'title', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'title'}}, {'name': 'uid', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'uid'}}, {'name': 'uid_agency_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'uid_agency_id'}}, {'name': 'work_unit', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'work_unit'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_staffs'}, 'cached': False, 'properties': {'displayName': 'myspa_staffs'}, 'primaryKey': ''}, {'name': 'myspa_orders', 'columns': [{'name': 'bed_ids', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'bed_ids'}}, {'name': 'branch_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'branch_id'}}, {'name': 'check_in', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'check_in'}}, {'name': 'check_out', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'check_out'}}, {'name': 'coupon_code', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'coupon_code'}}, {'name': 'coupon_discount_money', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'coupon_discount_money'}}, {'name': 'created_by_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_by_id'}}, {'name': 'created_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_date'}}, {'name': 'date_time_confirmed', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'date_time_confirmed'}}, {'name': 'deleted', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'deleted'}}, {'name': 'delivery_address', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'delivery_address'}}, {'name': 'delivery_status', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'delivery_status'}}, {'name': 'discount_money', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_money'}}, {'name': 'discount_percent', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_percent'}}, {'name': 'discount_symbol', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_symbol'}}, {'name': 'etl_inserted', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'etl_inserted'}}, {'name': 'given_money', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'given_money'}}, {'name': 'happy_hour_code', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'happy_hour_code'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'is_new_customer', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_new_customer'}}, {'name': 'list_prepay_card', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'list_prepay_card'}}, {'name': 'locker_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'locker_id'}}, {'name': 'log', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'log'}}, {'name': 'myspa_fee_momo', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'myspa_fee_momo'}}, {'name': 'myspa_percent_momo', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'myspa_percent_momo'}}, {'name': 'note', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'note'}}, {'name': 'order_code', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'order_code'}}, {'name': 'payment_method_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'payment_method_id'}}, {'name': 'payment_methods', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'payment_methods'}}, {'name': 'pet_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'pet_id'}}, {'name': 'platform', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'platform'}}, {'name': 'referral_uid', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'referral_uid'}}, {'name': 'signature_image', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'signature_image'}}, {'name': 'status', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'sub_total_money', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'sub_total_money'}}, {'name': 'tax', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'tax'}}, {'name': 'tax_money', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'tax_money'}}, {'name': 'tax_symbol', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'tax_symbol'}}, {'name': 'total_commission', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'total_commission'}}, {'name': 'total_money', 'type': 'BIGNUMERIC', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'total_money'}}, {'name': 'type', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'type'}}, {'name': 'uid', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'uid'}}, {'name': 'uid_confirmed', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'uid_confirmed'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_orders'}, 'cached': False, 'properties': {'displayName': 'myspa_orders'}, 'primaryKey': ''}, {'name': 'myspa_appointments', 'columns': [{'name': 'booking_code', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'booking_code'}}, {'name': 'booking_email', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'booking_email'}}, {'name': 'booking_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'booking_name'}}, {'name': 'booking_phone', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'booking_phone'}}, {'name': 'booking_quantity', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'booking_quantity'}}, {'name': 'booking_services', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'booking_services'}}, {'name': 'booking_type', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'booking_type'}}, {'name': 'branch_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'branch_id'}}, {'name': 'created_by_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_by_id'}}, {'name': 'created_date', 'type': 'TIMESTAMP', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_date'}}, {'name': 'deleted', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'deleted'}}, {'name': 'end_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'end_time'}}, {'name': 'etl_inserted', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'etl_inserted'}}, {'name': 'general_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'general_id'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'image', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'image'}}, {'name': 'is_room', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_room'}}, {'name': 'limit_room', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'limit_room'}}, {'name': 'modified_date', 'type': 'TIMESTAMP', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'modified_date'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'note', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'note'}}, {'name': 'order_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'order_id'}}, {'name': 'platform', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'platform'}}, {'name': 'pre_order_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'pre_order_id'}}, {'name': 'send_sms', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'send_sms'}}, {'name': 'send_zns', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'send_zns'}}, {'name': 'services_uid', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'services_uid'}}, {'name': 'staffs_uid', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'staffs_uid'}}, {'name': 'start_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'start_time'}}, {'name': 'status', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'title', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'title'}}, {'name': 'treatment_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'treatment_id'}}, {'name': 'uid', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'uid'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_appointments'}, 'cached': False, 'properties': {'displayName': 'myspa_appointments'}, 'primaryKey': ''}, {'name': 'myspa_order_lines', 'columns': [{'name': 'brand', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'brand'}}, {'name': 'commission', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'commission'}}, {'name': 'created_by_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_by_id'}}, {'name': 'created_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_date'}}, {'name': 'deleted', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'deleted'}}, {'name': 'discount', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount'}}, {'name': 'discount_unit', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_unit'}}, {'name': 'duration', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'duration'}}, {'name': 'etl_inserted', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'etl_inserted'}}, {'name': 'happy_hour_code', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'happy_hour_code'}}, {'name': 'hide_item_moba', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'hide_item_moba'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'item_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'item_id'}}, {'name': 'item_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'item_name'}}, {'name': 'note', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'note'}}, {'name': 'order_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'order_id'}}, {'name': 'pet_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'pet_id'}}, {'name': 'prepay', 'type': 'FLOAT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'prepay'}}, {'name': 'price', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'price'}}, {'name': 'price_after_discount', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'price_after_discount'}}, {'name': 'price_discount', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'price_discount'}}, {'name': 'promotion_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'promotion_id'}}, {'name': 'quantity', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'quantity'}}, {'name': 'remain_time', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'remain_time'}}, {'name': 'reward_money', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'reward_money'}}, {'name': 'reward_percent', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'reward_percent'}}, {'name': 'status', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'sub_total', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'sub_total'}}, {'name': 'temp_card_data', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'temp_card_data'}}, {'name': 'treatment_program', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'treatment_program'}}, {'name': 'type', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'type'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_order_lines'}, 'cached': False, 'properties': {'displayName': 'myspa_order_lines'}, 'primaryKey': ''}, {'name': 'myspa_services', 'columns': [{'name': 'category_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'category_id'}}, {'name': 'created_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_at'}}, {'name': 'deleted_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'deleted_at'}}, {'name': 'discount_ecommerce_price', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_ecommerce_price'}}, {'name': 'discount_moba_price', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_moba_price'}}, {'name': 'discount_price', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_price'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'on_ecommerce', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'on_ecommerce'}}, {'name': 'on_moba', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'on_moba'}}, {'name': 'organization_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'organization_id'}}, {'name': 'origin_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'origin_id'}}, {'name': 'price', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'price'}}, {'name': 'sku', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'sku'}}, {'name': 'status', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'stock', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'stock'}}, {'name': 'type', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'type'}}, {'name': 'updated_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_at'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_services'}, 'cached': False, 'properties': {'displayName': 'myspa_services'}, 'primaryKey': ''}, {'name': 'myspa_products', 'columns': [{'name': 'category_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'category_id'}}, {'name': 'created_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_at'}}, {'name': 'deleted_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'deleted_at'}}, {'name': 'discount_ecommerce_price', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_ecommerce_price'}}, {'name': 'discount_moba_price', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_moba_price'}}, {'name': 'discount_price', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'discount_price'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'on_ecommerce', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'on_ecommerce'}}, {'name': 'on_moba', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'on_moba'}}, {'name': 'organization_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'organization_id'}}, {'name': 'origin_id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'origin_id'}}, {'name': 'price', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'price'}}, {'name': 'sku', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'sku'}}, {'name': 'status', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'stock', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'stock'}}, {'name': 'type', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'type'}}, {'name': 'updated_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_at'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_products'}, 'cached': False, 'properties': {'displayName': 'myspa_products'}, 'primaryKey': ''}, {'name': 'staffs', 'columns': [{'name': 'create_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'create_at'}}, {'name': 'email', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'email'}}, {'name': 'id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'is_root', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'is_root'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'phone', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'phone'}}, {'name': 'status', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'updated_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_at'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'staffs'}, 'cached': False, 'properties': {'displayName': 'staffs'}, 'primaryKey': ''}, {'name': 'products', 'columns': [{'name': 'created_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_at'}}, {'name': 'id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'price', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'price'}}, {'name': 'status', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'updated_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_at'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'products'}, 'cached': False, 'properties': {'displayName': 'products'}, 'primaryKey': ''}, {'name': 'departments', 'columns': [{'name': 'created_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_at'}}, {'name': 'id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'key', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'key'}}, {'name': 'level_department', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'level_department'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}, {'name': 'numerical_order', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'numerical_order'}}, {'name': 'related_department', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'related_department'}}, {'name': 'status', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'status'}}, {'name': 'updated_at', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'updated_at'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'departments'}, 'cached': False, 'properties': {'displayName': 'departments'}, 'primaryKey': ''}, {'name': 'myspa_sources', 'columns': [{'name': 'created_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'created_date'}}, {'name': 'deleted', 'type': 'BOOL', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'deleted'}}, {'name': 'from_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'from_name'}}, {'name': 'id', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'modified_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'modified_date'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'myspa_sources'}, 'cached': False, 'properties': {'displayName': 'myspa_sources'}, 'primaryKey': ''}, {'name': 'team_staff', 'columns': [{'name': 'department_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'department_id'}}, {'name': 'role', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'role'}}, {'name': 'staff_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'staff_id'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'team_staff'}, 'cached': False, 'properties': {'displayName': 'team_staff'}, 'primaryKey': ''}, {'name': 'fb_page_metrics', 'columns': [{'name': 'end_time', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'end_time'}}, {'name': 'metric_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'metric_name'}}, {'name': 'page_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'page_id'}}, {'name': 'period', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'period'}}, {'name': 'value', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'value'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'fb_page_metrics'}, 'cached': False, 'properties': {'displayName': 'fb_page_metrics'}, 'primaryKey': ''}, {'name': 'fb_pages', 'columns': [{'name': 'id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'id'}}, {'name': 'name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'name'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'fb_pages'}, 'cached': False, 'properties': {'displayName': 'fb_pages'}, 'primaryKey': ''}, {'name': 'fb_instagram_metrics', 'columns': [{'name': 'instagram_id', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'instagram_id'}}, {'name': 'metric_date', 'type': 'DATETIME', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'metric_date'}}, {'name': 'metric_name', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'metric_name'}}, {'name': 'period', 'type': 'STRING', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'period'}}, {'name': 'value', 'type': 'INT64', 'isCalculated': False, 'notNull': False, 'properties': {'displayName': 'value'}}], 'tableReference': {'catalog': 'tensile-cogency-408304', 'schema': 'chancekim', 'table': 'fb_instagram_metrics'}, 'cached': False, 'properties': {'displayName': 'fb_instagram_metrics'}, 'primaryKey': ''}]\n\n\n\n\n\n\nCurrent Date: 2025-04-09 Wednesday 09:03:38\n\nPlease generate 3 insightful questions for each of the 3 categories based on the provided data model. Both the questions and category names should be translated into English. The output format should maintain the structure but with localized text."
}

messages = [{"role": "user", "content": prompt["prompt"]}]
model = "openrouter/google/gemini-2.0-flash-001"


# --- Main Execution Logic ---
def run_litellm_test():
    """Runs the LiteLLM completion test."""
    print("Attempting to call LiteLLM completion...")
    print(f"Model: {model}")
    print(f"Messages: {messages}")

    try:
        # Call the LiteLLM completion function
        response = completion(
            model=model,
            messages=messages,
            # Optional parameters below (can be added back if needed)
            api_base="https://openrouter.ai/api/v1",  # Often auto-detected for openrouter
            api_key="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",  # LiteLLM usually picks up the env variable automatically
            # transforms = [...] # Add valid transforms if needed
            # route = "..." # Add valid route if needed
        )

        # Print the full response object for inspection
        print("\n--- Full Response Object ---")
        print(response)

        # Print the content of the generated message
        print("\n--- Assistant's Reply ---")
        # Accessing the message content - structure might vary slightly
        # based on LiteLLM version and model, common paths are:
        # response.choices[0].message.content
        # response['choices'][0]['message']['content']
        if response.choices and len(response.choices) > 0:
            message_content = response.choices[0].message.content
            print(message_content)
        else:
            print("Could not find message content in the response.")

        print("\n--- Test Complete ---")

    except Exception as e:
        print("\n--- An Error Occurred ---")
        print(f"Error Type: {type(e).__name__}")
        print(f"Error Details: {e}")
        print("\n--- Test Failed ---")
        # You might want to print traceback for more detailed debugging
        # import traceback
        # traceback.print_exc()


# --- Run the script ---
if __name__ == "__main__":
    # Ensure litellm is installed: pip install litellm
    # print(f"LiteLLM Version: {litellm.__version__}")
    run_litellm_test()
